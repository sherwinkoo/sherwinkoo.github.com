---
layout: post
title: "Linux知识集锦"
date: 2015-10-06 18:30:00
categories: Linux
---

## **一、SSH**
--------

### 1. SSH中文乱码

***原因：***
这通常是由于服务器locale使用本地locale，但是服务器并没有安装相关语言包导致的。

***解决方法：***
在`/etc/ssh/ssh_config`中，把`SendEnv LANG LC_*`这一行注释掉即可。

## **二、AWK**

### 1. 对某一列进行累加

上周末由于接入的第三方支付升级导致的服务端回调参数错误，最终结果就是玩家支付成功来了，但是游戏并没有发送相关道具。由于需要和支付提供商核对失败订单以及确定此次事故的严重程度，所以需要统计一下失败的总金额。

**例子:**

假如x.log文件中有以下三条记录：

`127.0.0.1 - [21/Mar/2016:18:34:07 +0800] "GET /notify/pay/?fee=500&price=500 HTTP/1.1" 400 29 "-" "Java/1.6.0_22" 391 0.027 0.027 -`

`127.0.0.1 - [21/Mar/2016:18:37:07 +0800] "GET /notify/pay/?fee=500&price=500 HTTP/1.1" 400 29 "-" "Java/1.6.0_22" 391 0.021 0.021 -`

`127.0.0.1 - [21/Mar/2016:18:40:07 +0800] "GET /notify/pay/?fee=500&price=500 HTTP/1.1" 400 29 "-" "Java/1.6.0_22" 391 0.031 0.031 -` 

那么对应的命令就是：
`awk -F ' ' '{print $6}' x.log | awk -F 'fee=' '{print $2}' | awk -F '&' '{a=a+$1}END{print a}'`